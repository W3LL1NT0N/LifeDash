<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Life Dash v6.2 | Entrada</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
</head>
<body>
    <div id="loader"><i class="ph ph-spinner ph-spin" style="font-size: 2.5rem; color: var(--dark);"></i><div id="loader_msg" style="font-weight: 600; color: var(--text-sec);">Verificando...</div></div>

    <!-- 1. SETUP -->
    <div id="screen_setup" class="screen">
        <div class="center-box">
            <h2 style="margin-bottom: 0.5rem;">Configuração</h2>
            <p style="color: var(--text-sec); margin-bottom: 2rem;">Conecte seus Forms.</p>

            <div class="setup-card">
                <div class="block-title"><i class="ph ph-database"></i> 1. Registros</div>
                <span class="field-label">Form Link</span> <input type="text" id="cfg_form_rec" class="setup-input">
                <span class="field-label">CSV Link</span> <input type="text" id="cfg_csv_rec" class="setup-input">
            </div>
            <div class="setup-card">
                <div class="block-title"><i class="ph ph-list-checks"></i> 2. Listas/Token</div>
                <span class="field-label">Form Link</span> <input type="text" id="cfg_form_cat" class="setup-input">
                <span class="field-label">CSV Link</span> <input type="text" id="cfg_csv_cat" class="setup-input">
            </div>
            <div class="setup-card">
                <div class="block-title"><i class="ph ph-scroll"></i> 3. Logs</div>
                <span class="field-label">Form Link</span> <input type="text" id="cfg_form_log" class="setup-input">
                <span class="field-label">CSV Link</span> <input type="text" id="cfg_csv_log" class="setup-input">
            </div>

            <button class="btn-full" onclick="iniciar_diagnostico_setup()">CONECTAR</button>
            <div id="setup_diag" class="diag-list" style="display:none;"></div>
        </div>
    </div>

    <!-- 2. REGISTRO TOKEN -->
    <div id="screen_register" class="screen">
        <div class="center-box">
            <h1><i class="ph ph-shield-plus"></i></h1>
            <h2>Nova Senha Mestra</h2>
            <input type="password" id="reg_pass" class="setup-input" placeholder="Senha" style="text-align:center; letter-spacing:4px;">
            <input type="password" id="reg_pass_conf" class="setup-input" placeholder="Confirmar" style="text-align:center; letter-spacing:4px;">
            <button class="btn-full" id="btn_criar_token" onclick="registrar_token()">CRIAR</button>
        </div>
    </div>

    <!-- 3. WAIT -->
    <div id="screen_wait" class="screen">
        <div class="center-box">
            <h1 style="color: var(--fin);"><i class="ph ph-arrows-clockwise ph-spin"></i></h1>
            <h2>Sincronizando...</h2>
            <div id="wait_diag" class="diag-list">
                <div class="diag-item"><div class="d-icon d-ok"><i class="ph ph-check-circle"></i></div><span>Enviado</span></div>
                <div class="diag-item"><div class="d-icon d-load"><i class="ph ph-spinner"></i></div><span>Aguardando Google (<span id="try_count">1</span>)...</span></div>
            </div>
        </div>
    </div>

    <!-- 4. LOGIN -->
    <div id="screen_login" class="screen">
        <div class="center-box">
            <h1 style="margin-bottom: 2rem;"><i class="ph ph-lock-key"></i></h1>
            <input type="password" id="login_pass" class="setup-input" placeholder="Senha" style="text-align: center; letter-spacing: 4px; font-size: 1.2rem;" onkeyup="if(event.key==='Enter') auth()">
            <button class="btn-full" onclick="auth()">ENTRAR</button>
            <p id="login_err" style="color: var(--err); margin-top: 1rem; font-size: 0.8rem;"></p>
            <button class="btn-link" onclick="hard_reset()">Resetar Tudo</button>
        </div>
    </div>

    <script src="js/utils.js"></script>
    <script src="js/config.js"></script>
    <script src="js/auth.js"></script>
    <script>
        // Init Check
        window.onload = function() {
            init_setup(); // Defined in config.js
        }
    </script>
</body>
</html>